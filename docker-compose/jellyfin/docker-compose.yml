services:
  jellyfin:
    image: lscr.io/linuxserver/jellyfin:latest
    container_name: jellyfin
    environment:
      - PUID=${UID}
      - PGID=${GID}
      - TZ=America/New_York
      - JELLYFIN_PublishedServerUrl=http://192.168.12.140
    volumes:
      - /media/storage/jellyfin/config:/config
      - /media/storage/jellyfin/tvshows:/data/tvshows
      - /media/storage/jellyfin/movies:/data/movies
      - /media/storage/jellyfin/library_movies:/data/library_movies
      - /media/storage/jellyfin/library_tv:/data/library_tv
    ports:
      - 8096:8096
      - 8920:8920 #optional
      - 7359:7359/udp #optional
      - 1900:1900/udp #optional
    restart: unless-stopped

  radarr:
    image: lscr.io/linuxserver/radarr:latest
    container_name: radarr
    environment:
      - PUID=${UID}
      - PGID=${GID}
      - TZ=America/New_York
    volumes:
      - /media/storage/jellyfin/radarr/config:/config
      # CRITICAL: Map to the local movie library path
      - /media/storage/jellyfin/library_movies:/movies
      # CRITICAL: Map to the download directory for Radarr to process
      - /media/storage/jellyfin/downloads:/downloads
    ports:
      - 7878:7878
    restart: unless-stopped

  sonarr:
    image: lscr.io/linuxserver/sonarr:latest
    container_name: sonarr
    environment:
      - PUID=${UID}
      - PGID=${GID}
      - TZ=America/New_York
    volumes:
      - /media/storage/jellyfin/sonarr/config:/config
      # CRITICAL: Map to the local TV library path
      - /media/storage/jellyfin/library_tv:/tv
      # CRITICAL: Map to the download directory for Sonarr to process
      - /media/storage/jellyfin/downloads:/downloads
    ports:
      - 8989:8989
    restart: unless-stopped

  jellyseerr:
    image: ghcr.io/fallenbagel/jellyseerr:latest
    container_name: jellyseerr
    environment:
      - LOG_LEVEL=info
      - TZ=America/New_York
      - PORT=5055
    volumes:
      - /media/storage/jellyfin/jellyseerr/config:/app/config
    ports:
      - 5055:5055
    restart: unless-stopped

  rdtclient:
    image: rogerfar/rdtclient
    container_name: rdtclient
    environment:
      - PUID=${UID}
      - PGID=${GID}
      - TZ=America/New_York
    volumes:
      - /media/storage/jellyfin/rdtclient/config:/data/db
      # CRITICAL: Local path for downloaded files
      - /media/storage/jellyfin/downloads:/data/downloads
    ports:
      - 6500:6500
    restart: unless-stopped

  autoscan:
    image: ghcr.io/hotio/autoscan
    container_name: autoscan
    environment:
      - PUID=${UID}
      - PGID=${GID}
      - TZ=America/New_York
    volumes:
      - /media/storage/jellyfin/autoscan/config:/config
      # CRITICAL: Mount library paths to monitor
      - /media/storage/jellyfin/library_movies:/media/storage/jellyfin/library_movies:ro
      - /media/storage/jellyfin/library_tv:/media/storage/jellyfin/library_tv:ro
    ports:
      - 3030:3030
    restart: unless-stopped

  prowlarr:
    image: lscr.io/linuxserver/prowlarr:latest
    container_name: prowlarr
    environment:
      - PUID=${UID}
      - PGID=${GID}
      - TZ=America/New_York
    volumes:
      - /media/storage/jellyfin/prowlarr/config:/config
    ports:
      - 9696:9696
    restart: unless-stopped

  flaresolverr:
    image: ghcr.io/flaresolverr/flaresolverr:latest
    container_name: flaresolverr
    restart: unless-stopped
    environment:
      - LOG_LEVEL=info
      - LOG_HTML=false
      - CAPTCHA_SOLVER=none
    ports:
      - "8191:8191"
